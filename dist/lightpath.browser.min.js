"use strict";function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}function _instanceof(t,e){return null!=e&&"undefined"!=typeof Symbol&&e[Symbol.hasInstance]?!!e[Symbol.hasInstance](t):t instanceof e}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!_instanceof(t,e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){return!e||"object"!==_typeof(e)&&"function"!=typeof e?_assertThisInitialized(t):e}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&_setPrototypeOf(t,e)}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,r)}function r(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return r.prototype=Object.create(t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(r,t)})(t)}function isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _construct(t,e,r){return(_construct=isNativeReflectConstruct()?Reflect.construct:function(t,e,r){var n=[null];n.push.apply(n,e);var o=new(Function.bind.apply(t,n));return r&&_setPrototypeOf(o,r.prototype),o}).apply(null,arguments)}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,e){return(_setPrototypeOf=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var RequestError=function(t){function e(t,r){var n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).response=r,n.status=r.status,n.body=o,n}return _inherits(e,_wrapNativeSuper(Error)),e}(),RequestTimeout=function(t){function e(t,r){var n;return _classCallCheck(this,e),(n=_possibleConstructorReturn(this,_getPrototypeOf(e).call(this,t))).url=r,n}return _inherits(e,_wrapNativeSuper(Error)),e}(),LightPath=function(){function t(e){var r=e.baseURL,n=void 0===r?"":r,o=e.headers,i=void 0===o?{}:o,u=e.query,s=void 0===u?"":u,a=e.timeout,c=void 0===a?8e3:a,f=e.onRequest,l=void 0===f?function(t,e){}:f,h=e.onComplete,y=void 0===h?function(t){}:h,p=e.onError,d=void 0===p?function(t){}:p;_classCallCheck(this,t),this.baseURL=n,this.defaultHeaders=i,this.defaultQuery=s,this.timeout=c,this.onRequest=l,this.onComplete=y,this.onError=d,this.defaultOptions=e,this.defaultQuery&&"?"!=this.defaultQuery[0]&&(this.defaultQuery="?"+this.defaultQuery)}return _createClass(t,[{key:"request",value:async function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{t.includes("//")||(t=this.baseURL+("/"==t[0]?t:"/"+t),t+=this.defaultQuery?this.defaultQuery:"");var r=new AbortController,n=r.signal;this.onRequest(t,e);var o=!1;setTimeout(function(){o||r.abort()},this.timeout);var i,u=await this.__start_request(t,n,e);o=!0;try{i=await u.json()}catch(t){}if(u.ok)return this.onComplete(i),i;throw new RequestError("".concat(u.status," ").concat(u.statusText),u,i)}catch(e){throw e.status||(e=new RequestTimeout("[REQUEST_FAILED] Timeout",t)),this.onError(e),e}}},{key:"__start_request",value:async function(t,e,r){return fetch(t,{...this.defaultOptions,signal:e,method:"GET",headers:{"Content-Type":"application/json",...this.defaultHeaders},...r})}},{key:"get",value:async function(t){try{return await this.request(t)}catch(t){throw t}}},{key:"post",value:async function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this.request(t,{method:"POST",body:JSON.stringify(e)})}catch(t){throw t}}},{key:"put",value:async function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this.request(t,{method:"PUT",body:JSON.stringify(e)})}catch(t){throw t}}},{key:"delete",value:async function(t){try{return await this.request(t,{method:"DELETE"})}catch(t){throw t}}}],[{key:"request",value:async function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{t.includes("//")||(t="/"==t[0]?t:"/"+t);var r=new AbortController,n=r.signal,o=fetch(t,{signal:n,method:"GET",headers:{"Content-Type":"application/json"},...e});n.onabort=function(e){throw new RequestTimeout("[REQUEST_FAILED] Timeout",t)},setTimeout(function(){r.abort()},1e4);var i=await o,u=await i.json();if(i.ok)return u;throw new RequestError(u.message,o)}catch(t){throw t}}},{key:"get",value:async function(t){try{return await this.request(t)}catch(t){throw t}}},{key:"post",value:async function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this.request(t,{method:"POST",body:JSON.stringify(e)})}catch(t){throw t}}},{key:"put",value:async function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return await this.request(t,{method:"PUT",body:JSON.stringify(e)})}catch(t){throw t}}},{key:"delete",value:async function(t){try{return await this.request(t,{method:"DELETE"})}catch(t){throw t}}}]),t}();